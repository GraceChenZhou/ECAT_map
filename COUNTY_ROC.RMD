---
title: "Predictions of Rapid Cystic Fibrosis Lung Disease Progression Informed by Socioeconomic Deprivation and Traffic-Related Air Pollution Exposure"
subtitle: "Example Plot of Rate of Change: Hamilton County"
author: "Grace C. Zhou"
date:   'Update: `r format(Sys.Date(), "%B %d, %Y")`'
header-includes:
   - \usepackage{bbm}
output:
  html_document: 
    df_print: paged
    code_folding: hide
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: TRUE
    fig_caption: yes
    theme: flatly
bibliography: ECAT_refs.bib
link-citations: yes
---

```{r setup,echo=FALSE,warning = FALSE, message= FALSE}

knitr::opts_chunk$set(cache = FALSE, 
                      warning = FALSE, message= FALSE)

library(rmarkdown)
library(dplyr)
library(tmap)

indata <- readRDS('subData_ROC.rds')

```

# Introduction

The plot was generated by the subset data for Hamilton County ONLY with a total of `r nrow(indata)` observations.

# Rate of Change

## Overall

```{r}

OVERALL=indata %>% select(.,starts_with("change_")) %>% 
  mutate(ECAT=round(change_ecat,2),
         `Deprivation Index`=round(change_depind,2),
         Drive=round(change_drive,2),
         Green=round(change_green,2),
         Overall=round(change_total,2))


tmap_mode("view") #interactive plot
map.OV <- tm_basemap('CartoDB.Positron') +
  tm_shape(OVERALL) +
  tm_polygons(col = 'Overall', palette = "-RdYlGn", 
              border.col = NA,interactive = TRUE,style = "cont", alpha=0.5, 
              border.alpha = 0,lwd = .01, id='Overall',
              popup.vars=c('ECAT'='ECAT',
                           'Dep. Index'='Deprivation Index',
                           'Green'='Green',
                           'Drive'='Drive'))

map.OV

```

## ECAT

```{r}

tmap_mode("view")
map.ECAT <- tm_basemap('CartoDB.Positron') +
    tm_shape(OVERALL) +
    tm_polygons(col = 'ECAT', palette = "-RdYlGn",
              border.col = NA,interactive = TRUE,style = "cont", alpha=0.5,
              border.alpha = 0,lwd = .01, id='ECAT',
              popup.vars=c('Dep. Index'='Deprivation Index',
                           'Green'='Green',
                           'Drive'='Drive',
                           'Overall'='Overall'))

map.ECAT

```

## Deprivation Index

```{r}

tmap_mode("view")
map.DPI <- tm_basemap('CartoDB.Positron') +
  tm_shape(OVERALL) +
    tm_polygons(col = 'Deprivation Index', palette = "-RdYlGn",
              border.col = NA,interactive = TRUE,style = "cont", alpha=0.5,
              border.alpha = 0,lwd = .01, id='Deprivation Index',
              popup.vars=c('ECAT'='ECAT',
                           'Green'='Green',
                           'Drive'='Drive',
                           'Overall'='Overall'))

map.DPI

```

## Green space

```{r}

tmap_mode("view")
map.GN <- tm_basemap('CartoDB.Positron') +
  tm_shape(OVERALL) +
    tm_polygons(col = 'Green', palette = "-RdYlGn",
              border.col = NA,interactive = TRUE,style = "cont", alpha=0.5,
              border.alpha = 0,lwd = .01, id='Green',
              popup.vars=c('ECAT'='ECAT',
                           'Dep. Index'='Deprivation Index',
                           'Drive'='Drive',
                           'Overall'='Overall'))

map.GN

```

## Drive time

```{r}

tmap_mode("view")
map.DVT <- tm_basemap('CartoDB.Positron') +
  tm_shape(OVERALL) +
    tm_polygons(col = 'Drive', palette = "-RdYlGn",
              border.col = NA,interactive = TRUE,style = "cont", alpha=0.5,
              border.alpha = 0,lwd = .01, id='Drive',
              popup.vars=c('ECAT'='ECAT',
                           'Dep. Index'='Deprivation Index',
                           'Green'='Green',
                           'Overall'='Overall'))

map.DVT

```

# Acknowledgement

The author is grateful to all of helps and supports from the team group: Andrew Vancil, Richard (Cole) Brokamp, Emrah Gecili, Rhonda Szczesniak, etc.   

# Notes

* This .html file was executed by R version 4.0.2 (2020-06-22)[@r_r_2020] with R package **tmap V3.3-2**[@tennekes_tmap_2018], **rmarkdown V2.9**[@allaire_rmarkdown_2021], **dplyr V1.0.5**[@wickham_dplyr_2021]. 

# References